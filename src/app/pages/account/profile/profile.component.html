<div class="profile-container min-h-screen bg-gray-50 py-8">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900">Account Settings</h1>
      <p class="text-gray-600 mt-2">Manage your account information and preferences</p>
    </div>

    <!-- Profile Tabs -->
    <p-tabView styleClass="profile-tabs">
      <!-- Personal Information Tab -->
      <p-tabPanel header="Personal Information" leftIcon="pi pi-user">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <!-- Avatar Section -->
          <div class="lg:col-span-1">
            <p-card>
              <ng-template pTemplate="content">
                <div class="text-center">
                  <div class="mb-4">
                    <p-avatar 
                      [label]="getUserInitials()" 
                      size="xlarge" 
                      shape="circle"
                      styleClass="bg-indigo-600 text-white text-3xl font-semibold mx-auto"
                    ></p-avatar>
                  </div>
                  <h3 class="text-lg font-semibold text-gray-900 mb-2">Profile Picture</h3>
                  <p class="text-sm text-gray-600 mb-4">Upload a new profile picture</p>
                  
                  <p-fileUpload 
                    mode="basic" 
                    name="avatar"
                    accept="image/*"
                    maxFileSize="5000000"
                    chooseLabel="Choose Photo"
                    chooseIcon="pi pi-camera"
                    styleClass="p-button-outlined w-full"
                    (onSelect)="onAvatarUpload($event)"
                  ></p-fileUpload>
                  
                  <p class="text-xs text-gray-500 mt-2">Max file size: 5MB</p>
                </div>
              </ng-template>
            </p-card>
          </div>

          <!-- Profile Form -->
          <div class="lg:col-span-2">
            <p-card>
              <ng-template pTemplate="content">
                <form [formGroup]="profileForm" (ngSubmit)="onSubmitProfile()">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- First Name -->
                    <div>
                      <label for="firstName" class="block text-sm font-medium text-gray-700 mb-2">
                        First Name *
                      </label>
                      <input 
                        pInputText 
                        id="firstName"
                        formControlName="firstName"
                        placeholder="Enter your first name"
                        [class]="'w-full ' + (isFieldInvalid(profileForm, 'firstName') ? 'ng-invalid ng-dirty' : '')"
                      />
                      <small *ngIf="getFieldError(profileForm, 'firstName')" class="p-error block mt-1">
                        {{ getFieldError(profileForm, 'firstName') }}
                      </small>
                    </div>

                    <!-- Last Name -->
                    <div>
                      <label for="lastName" class="block text-sm font-medium text-gray-700 mb-2">
                        Last Name *
                      </label>
                      <input 
                        pInputText 
                        id="lastName"
                        formControlName="lastName"
                        placeholder="Enter your last name"
                        [class]="'w-full ' + (isFieldInvalid(profileForm, 'lastName') ? 'ng-invalid ng-dirty' : '')"
                      />
                      <small *ngIf="getFieldError(profileForm, 'lastName')" class="p-error block mt-1">
                        {{ getFieldError(profileForm, 'lastName') }}
                      </small>
                    </div>

                    <!-- Email -->
                    <div class="md:col-span-2">
                      <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                        Email Address *
                      </label>
                      <input 
                        pInputText 
                        id="email"
                        type="email"
                        formControlName="email"
                        placeholder="Enter your email address"
                        [class]="'w-full ' + (isFieldInvalid(profileForm, 'email') ? 'ng-invalid ng-dirty' : '')"
                      />
                      <small *ngIf="getFieldError(profileForm, 'email')" class="p-error block mt-1">
                        {{ getFieldError(profileForm, 'email') }}
                      </small>
                    </div>

                    <!-- Phone -->
                    <div>
                      <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                        Phone Number
                      </label>
                      <input 
                        pInputText 
                        id="phone"
                        type="tel"
                        formControlName="phone"
                        placeholder="Enter your phone number"
                        class="w-full"
                      />
                    </div>

                    <!-- Gender -->
                    <div>
                      <label for="gender" class="block text-sm font-medium text-gray-700 mb-2">
                        Gender
                      </label>
                      <p-dropdown 
                        id="gender"
                        formControlName="gender"
                        [options]="genderOptions"
                        placeholder="Select gender"
                        styleClass="w-full"
                      ></p-dropdown>
                    </div>

                    <!-- Date of Birth -->
                    <div class="md:col-span-2">
                      <label for="dateOfBirth" class="block text-sm font-medium text-gray-700 mb-2">
                        Date of Birth
                      </label>
                      <p-calendar 
                        id="dateOfBirth"
                        formControlName="dateOfBirth"
                        placeholder="Select your date of birth"
                        [showIcon]="true"
                        [maxDate]="maxDate"
                        dateFormat="mm/dd/yy"
                        styleClass="w-full"
                      ></p-calendar>
                    </div>
                  </div>

                  <p-divider></p-divider>

                  <div class="flex justify-end">
                    <button 
                      pButton 
                      type="submit"
                      label="Save Changes"
                      icon="pi pi-save"
                      [loading]="isLoading()"
                      [disabled]="profileForm.invalid"
                    ></button>
                  </div>
                </form>
              </ng-template>
            </p-card>
          </div>
        </div>
      </p-tabPanel>

      <!-- Security Tab -->
      <p-tabPanel header="Security" leftIcon="pi pi-shield">
        <div class="max-w-2xl">
          <p-card>
            <ng-template pTemplate="header">
              <div class="p-4 border-b">
                <h2 class="text-lg font-semibold text-gray-900">Change Password</h2>
                <p class="text-sm text-gray-600">Update your password to keep your account secure</p>
              </div>
            </ng-template>
            <ng-template pTemplate="content">
              <form [formGroup]="passwordForm" (ngSubmit)="onSubmitPassword()">
                <div class="space-y-6">
                  <!-- Current Password -->
                  <div>
                    <label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-2">
                      Current Password *
                    </label>
                    <p-password 
                      id="currentPassword"
                      formControlName="currentPassword"
                      placeholder="Enter your current password"
                      [feedback]="false"
                      [toggleMask]="true"
                      styleClass="w-full"
                      inputStyleClass="w-full"
                    ></p-password>
                    <small *ngIf="getFieldError(passwordForm, 'currentPassword')" class="p-error block mt-1">
                      {{ getFieldError(passwordForm, 'currentPassword') }}
                    </small>
                  </div>

                  <!-- New Password -->
                  <div>
                    <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-2">
                      New Password *
                    </label>
                    <p-password 
                      id="newPassword"
                      formControlName="newPassword"
                      placeholder="Enter your new password"
                      [feedback]="true"
                      [toggleMask]="true"
                      styleClass="w-full"
                      inputStyleClass="w-full"
                    ></p-password>
                    <small *ngIf="getFieldError(passwordForm, 'newPassword')" class="p-error block mt-1">
                      {{ getFieldError(passwordForm, 'newPassword') }}
                    </small>
                  </div>

                  <!-- Confirm Password -->
                  <div>
                    <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-2">
                      Confirm New Password *
                    </label>
                    <p-password 
                      id="confirmPassword"
                      formControlName="confirmPassword"
                      placeholder="Confirm your new password"
                      [feedback]="false"
                      [toggleMask]="true"
                      styleClass="w-full"
                      inputStyleClass="w-full"
                    ></p-password>
                    <small *ngIf="getFieldError(passwordForm, 'confirmPassword')" class="p-error block mt-1">
                      {{ getFieldError(passwordForm, 'confirmPassword') }}
                    </small>
                  </div>
                </div>

                <p-divider></p-divider>

                <div class="flex justify-end">
                  <button 
                    pButton 
                    type="submit"
                    label="Update Password"
                    icon="pi pi-lock"
                    [loading]="isPasswordLoading()"
                    [disabled]="passwordForm.invalid"
                  ></button>
                </div>
              </form>
            </ng-template>
          </p-card>
        </div>
      </p-tabPanel>

      <!-- Notifications Tab -->
      <p-tabPanel header="Notifications" leftIcon="pi pi-bell">
        <div class="max-w-2xl">
          <p-card>
            <ng-template pTemplate="header">
              <div class="p-4 border-b">
                <h2 class="text-lg font-semibold text-gray-900">Notification Preferences</h2>
                <p class="text-sm text-gray-600">Choose how you want to be notified</p>
              </div>
            </ng-template>
            <ng-template pTemplate="content">
              <div class="space-y-6">
                <!-- Email Notifications -->
                <div>
                  <h3 class="text-md font-medium text-gray-900 mb-4">Email Notifications</h3>
                  <div class="space-y-4">
                    <div class="flex items-center justify-between">
                      <div>
                        <label class="text-sm font-medium text-gray-700">Order Updates</label>
                        <p class="text-sm text-gray-500">Receive emails about your order status</p>
                      </div>
                      <p-inputSwitch 
                      [(ngModel)]="notificationSettings().emailOrders"
                      (onChange)="onNotificationChange('emailOrders', $event.checked)"
                    ></p-inputSwitch>
                    </div>
                    
                    <div class="flex items-center justify-between">
                      <div>
                        <label class="text-sm font-medium text-gray-700">Marketing & Promotions</label>
                        <p class="text-sm text-gray-500">Receive emails about sales and new products</p>
                      </div>
                      <p-inputSwitch 
                      [(ngModel)]="notificationSettings().emailMarketing"
                      (onChange)="onNotificationChange('emailMarketing', $event.checked)"
                    ></p-inputSwitch>
                    </div>
                    
                    <div class="flex items-center justify-between">
                      <div>
                        <label class="text-sm font-medium text-gray-700">Security Alerts</label>
                        <p class="text-sm text-gray-500">Receive emails about account security</p>
                      </div>
                      <p-inputSwitch 
                      [(ngModel)]="notificationSettings().emailSecurity"
                      (onChange)="onNotificationChange('emailSecurity', $event.checked)"
                    ></p-inputSwitch>
                    </div>
                  </div>
                </div>

                <p-divider></p-divider>

                <!-- SMS Notifications -->
                <div>
                  <h3 class="text-md font-medium text-gray-900 mb-4">SMS Notifications</h3>
                  <div class="space-y-4">
                    <div class="flex items-center justify-between">
                      <div>
                        <label class="text-sm font-medium text-gray-700">Order Updates</label>
                        <p class="text-sm text-gray-500">Receive SMS about your order status</p>
                      </div>
                      <p-inputSwitch 
                      [(ngModel)]="notificationSettings().smsOrders"
                      (onChange)="onNotificationChange('smsOrders', $event.checked)"
                    ></p-inputSwitch>
                    </div>
                    
                    <div class="flex items-center justify-between">
                      <div>
                        <label class="text-sm font-medium text-gray-700">Marketing & Promotions</label>
                        <p class="text-sm text-gray-500">Receive SMS about sales and new products</p>
                      </div>
                      <p-inputSwitch 
                      [(ngModel)]="notificationSettings().smsMarketing"
                      (onChange)="onNotificationChange('smsMarketing', $event.checked)"
                    ></p-inputSwitch>
                    </div>
                  </div>
                </div>

                <p-divider></p-divider>

                <!-- Push Notifications -->
                <div>
                  <h3 class="text-md font-medium text-gray-900 mb-4">Push Notifications</h3>
                  <div class="flex items-center justify-between">
                    <div>
                      <label class="text-sm font-medium text-gray-700">Browser Notifications</label>
                      <p class="text-sm text-gray-500">Receive push notifications in your browser</p>
                    </div>
                    <p-inputSwitch 
                      [(ngModel)]="notificationSettings().pushNotifications"
                      (onChange)="onNotificationChange('pushNotifications', $event.checked)"
                    ></p-inputSwitch>
                  </div>
                </div>
              </div>
            </ng-template>
          </p-card>
        </div>
      </p-tabPanel>

      <!-- Account Tab -->
      <p-tabPanel header="Account" leftIcon="pi pi-cog">
        <div class="max-w-2xl space-y-6">
          <!-- Account Information -->
          <p-card>
            <ng-template pTemplate="header">
              <div class="p-4 border-b">
                <h2 class="text-lg font-semibold text-gray-900">Account Information</h2>
              </div>
            </ng-template>
            <ng-template pTemplate="content">
              <div class="space-y-4">
                <div class="flex justify-between items-center">
                  <div>
                    <p class="text-sm font-medium text-gray-700">Account Status</p>
                    <p class="text-sm text-gray-500">Your account is active</p>
                  </div>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    Active
                  </span>
                </div>
                
                <div class="flex justify-between items-center">
                  <div>
                    <p class="text-sm font-medium text-gray-700">Member Since</p>
                    <p class="text-sm text-gray-500">January 2024</p>
                  </div>
                </div>
                
                <div class="flex justify-between items-center">
                  <div>
                    <p class="text-sm font-medium text-gray-700">Account Type</p>
                    <p class="text-sm text-gray-500">Standard Customer</p>
                  </div>
                </div>
              </div>
            </ng-template>
          </p-card>

          <!-- Danger Zone -->
          <p-card styleClass="border-red-200">
            <ng-template pTemplate="header">
              <div class="p-4 border-b border-red-200">
                <h2 class="text-lg font-semibold text-red-900">Danger Zone</h2>
                <p class="text-sm text-red-600">Irreversible and destructive actions</p>
              </div>
            </ng-template>
            <ng-template pTemplate="content">
              <div class="space-y-4">
                <div class="flex justify-between items-start">
                  <div>
                    <p class="text-sm font-medium text-gray-700">Delete Account</p>
                    <p class="text-sm text-gray-500">Permanently delete your account and all associated data</p>
                  </div>
                  <button 
                    pButton 
                    type="button"
                    label="Delete Account"
                    icon="pi pi-trash"
                    class="p-button-danger p-button-outlined"
                    (click)="deleteAccount()"
                  ></button>
                </div>
              </div>
            </ng-template>
          </p-card>
        </div>
      </p-tabPanel>
    </p-tabView>
  </div>
</div>

<!-- Toast Messages -->
<p-toast></p-toast>

<!-- Confirmation Dialog -->
<p-confirmDialog></p-confirmDialog>